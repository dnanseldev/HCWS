/*RELATÓRIO CLOVIS ENGENHARIA*/
--=============================

/*
 - 5744 Mario Roberto Teixeira
 - 62795 MARCIO ZAMBONATO
*/
SELECT *
  FROM USUARIO U
 WHERE 1 = 1
      -- AND u.num_user_banco = 5744;
   AND U.NOM_USUARIO LIKE '%MARCIO%';

SELECT * FROM ORDEM_SERVICO OS;
-----------------------
SELECT --num_ordem,
 OS.NUM_ORDEM_SERVICO,
 OS.ANO_ORDEM_SERVICO,
 NUM_TRIAGEM_OS,
 U.NOM_USUARIO || ' ' || U.SBN_USUARIO FUNCIONARIO,
 --os.cod_situacao_os,
 TSO.DSC_SITUACAO_OS SITUACAO_OS,
 --os.cod_unidade_executante,
 UI.NOM_UNIDADE_EXECUTANTE,
 OS.COD_CENCUSTO           SOLICITANTE,
 CC.NOM_CENCUSTO,
 --os.num_user_banco,
 OS.DTA_CRIACAO_OS,
 OS.NUM_RAMAL,
 OS.COD_LOCAL,
 --os.num_bem,
 --os.num_man_preventiva,
 OS.NOM_CONTATO,
 OS.CPL_LOCAL,
 OS.DSC_SERVICO,
 OS.DTA_HOR_HISTORICO,
 OS.DTA_HOR_FINALIZACAO
--os.num_id_glpi
  FROM ORDEM_SERVICO OS
  JOIN TIPO_SITUACAO_OS TSO USING (COD_SITUACAO_OS)
  JOIN TRIAGEM_ORDEM_SERVICO TOS USING (NUM_ORDEM)
  JOIN FUNCIONARIO_ORDEM_SERVICO FOS USING (NUM_TRIAGEM_OS)
  JOIN FUNCIONARIO_UNIDADE_EXECUTANTE FUE USING (NUM_FUNC_UNIDADE)
  JOIN USUARIO U USING (NUM_USER_BANCO)
  JOIN UNIDADE_EXECUTANTE UI
    ON UI.COD_UNIDADE_EXECUTANTE = OS.COD_UNIDADE_EXECUTANTE
  JOIN CENTRO_CUSTO CC
    ON CC.COD_CENCUSTO = OS.COD_CENCUSTO
 WHERE 1 = 1
   AND NUM_FUNC_UNIDADE = 2969 --1857
 ORDER BY 8 DESC;
-----------------------
SELECT *
  FROM GENERICO.FUNCIONARIO_ORDEM_SERVICO T
 WHERE 1 = 1
   AND NUM_FUNC_UNIDADE = 2969; --1857;
--AND num_func_unidade in (298, 395, 1857);
-----------------------
SELECT *
  FROM GENERICO.FUNCIONARIO_UNIDADE_EXECUTANTE T
 WHERE T.NUM_USER_BANCO = 62795
   AND T.IDF_ATIVO = 0; --5744;
-------------------------
SELECT *
  FROM GENERICO.UNIDADE_EXECUTANTE T
 WHERE T.COD_UNIDADE_EXECUTANTE
      --in (30, 31, 127);
       IN (2, 22, 6);
-----------------------------
SELECT   U.NOM_USUARIO || ' ' || U.SBN_USUARIO FUNCIONARIO_APONTAMENTO,
         OS.NUM_ORDEM_SERVICO,
         OS.ANO_ORDEM_SERVICO,
         TSO.DSC_SITUACAO_OS SITUACAO_OS,
         OS.COD_CENCUSTO CC_SOLICITANTE,
         COD_LOCAL,
         LC.NOM_LOCAL,
         NUM_BEM,
         BP.NUM_PATRIMONIO,
         TP.DSC_TIPO_PATRIMONIO,
         BP.NUM_SERIE,
         OS.DSC_SERVICO,
         ATV.DTA_HOR_INICIO_ATIVIDADE,
         ATV.DTA_HOR_APONTAMENTO,
         ATV.DTA_HOR_FIM_ATIVIDADE,
         ATV.VLR_HOR_APONTAMENTO,
         AHC.DSC_ATIVIDADE_HC,
         ATV.CPL_ATIVIDADE
  FROM GENERICO.APONTAMENTO_ATIVIDADE ATV
  JOIN USUARIO U ON U.NUM_USER_BANCO = ATV.NUM_USER_APONTAMENTO
  JOIN ATIVIDADE_HC AHC USING(COD_ATIVIDADE_HC)
  LEFT JOIN TRIAGEM_ORDEM_SERVICO TOS USING(NUM_TRIAGEM_OS)
  LEFT JOIN ORDEM_SERVICO OS USING(NUM_ORDEM)
  LEFT JOIN TIPO_SITUACAO_OS TSO USING (COD_SITUACAO_OS)
  LEFT JOIN  LOCAL LC USING(COD_LOCAL)
  LEFT JOIN BEM_PATRIMONIAL BP USING(NUM_BEM)
  LEFT JOIN TIPO_PATRIMONIO TP ON TP.COD_TIPO_PATRIMONIO = BP.COD_TIPO_PATRIMONIO
  WHERE 1 = 1
  --AND ATV.NUM_FUNC_UNIDADE = 2969
  AND OS.NUM_ORDEM_SERVICO = 42654
  AND OS.ANO_ORDEM_SERVICO = 2023
  ORDER BY OS.DTA_CRIACAO_OS DESC;
------------------------------
/*V2*/
SELECT   U.NOM_USUARIO || ' ' || U.SBN_USUARIO FUNCIONARIO_APONTAMENTO,
         OS.NUM_ORDEM_SERVICO,
         OS.ANO_ORDEM_SERVICO,
         TSO.DSC_SITUACAO_OS SITUACAO_OS,
         OS.COD_CENCUSTO CC_SOLICITANTE,
         COD_LOCAL,
         LC.NOM_LOCAL,
         --NUM_BEM,
         BP.NUM_PATRIMONIO,
         TP.DSC_TIPO_PATRIMONIO,
         bp.dsc_complementar
         BP.NUM_SERIE,
         OS.DSC_SERVICO,
         ATV.DTA_HOR_INICIO_ATIVIDADE,
         ATV.DTA_HOR_APONTAMENTO,
         ATV.DTA_HOR_FIM_ATIVIDADE,
         ATV.VLR_HOR_APONTAMENTO,
         AHC.DSC_ATIVIDADE_HC,
         ATV.CPL_ATIVIDADE
  FROM  ORDEM_SERVICO OS 
  JOIN LOCAL LC USING(COD_LOCAL)
  LEFT JOIN BEM_PATRIMONIAL BP USING(NUM_BEM)
  LEFT JOIN TIPO_PATRIMONIO TP USING(COD_TIPO_PATRIMONIO)
  JOIN TRIAGEM_ORDEM_SERVICO TOS USING(NUM_ORDEM)
  LEFT JOIN FUNCIONARIO_ORDEM_SERVICO FOS USING(NUM_TRIAGEM_OS)
  LEFT JOIN FUNCIONARIO_UNIDADE_EXECUTANTE FUE USING(NUM_FUNC_UNIDADE)
  LEFT JOIN USUARIO U ON U.NUM_USER_BANCO = FUE.NUM_USER_BANCO
  LEFT JOIN GENERICO.APONTAMENTO_ATIVIDADE ATV USING(SEQ_FUNC_ORDEM_SERVICO)
  LEFT JOIN TIPO_SITUACAO_OS TSO USING (COD_SITUACAO_OS)
  LEFT JOIN ATIVIDADE_HC AHC USING(COD_ATIVIDADE_HC)
  WHERE 1 = 1
  AND U.NUM_USER_BANCO = 62795
  --AND OS.NUM_ORDEM_SERVICO = 42654
  --AND OS.ANO_ORDEM_SERVICO = 2023
  ORDER BY OS.DTA_CRIACAO_OS DESC;  
------------------------------
SELECT *
 FROM Ordem_Servico OS
 WHERE 1 = 1
 AND OS.NUM_ORDEM_SERVICO = 42654
 AND OS.ANO_ORDEM_SERVICO = 2023;
 
 --2366311
------------------------------
SELECT   U.NOM_USUARIO || ' ' || U.SBN_USUARIO FUNCIONARIO_APONTAMENTO
        ,ATV.*
  FROM GENERICO.APONTAMENTO_ATIVIDADE ATV
  JOIN USUARIO U ON U.NUM_USER_BANCO = ATV.NUM_USER_APONTAMENTO
 WHERE NUM_TRIAGEM_OS IN (2366311);
    

              
   
             
             
               
   
     
       
          
